<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Client (amqp-client-lwt.Amqp_client_lwt__Rpc.Client)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">amqp-client-lwt</a> &#x00BB; <a href="../index.html">Amqp_client_lwt__Rpc</a> &#x00BB; Client</nav><h1>Module <code>Amqp_client_lwt__Rpc.Client</code></h1><p>Rpc Client pattern</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : <span>id:string</span> <span>&#45;&gt;</span> <a href="../../Amqp_client_lwt/Connection/index.html#type-t">Amqp_client_lwt.Connection.t</a> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../Amqp_client_lwt/Thread/Deferred/index.html#type-t">Amqp_client_lwt.Thread.Deferred.t</a></span></code></dt><dd><p>Initialize a client with the <code>id</code> for tracing</p></dd></dl><dl><dt class="spec value" id="val-call"><a href="#val-call" class="anchor"></a><code><span class="keyword">val</span> call : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>?&#8288;correlation_id:string</span> <span>&#45;&gt;</span> <span>ttl:int</span> <span>&#45;&gt;</span> <span>?&#8288;grace_time_ms:int</span> <span>&#45;&gt;</span> <span>routing_key:string</span> <span>&#45;&gt;</span> <span>headers:<span><a href="../../../amqp-client/Amqp_client_lib/Types/index.html#type-header">Amqp_client_lib.Types.header</a> list</span></span> <span>&#45;&gt;</span> <span><span class="type-var">_</span> <a href="../../Amqp_client_lwt/Exchange/index.html#type-t">Amqp_client_lwt.Exchange.t</a></span> <span>&#45;&gt;</span> <span>(<a href="../../Amqp_client_lwt/Spec/Basic/Content/index.html#type-t">Amqp_client_lwt.Spec.Basic.Content.t</a> * string)</span> <span>&#45;&gt;</span> <span><span><a href="../../Amqp_client_lwt/Message/index.html#type-message">Amqp_client_lwt.Message.message</a> option</span> <a href="../../Amqp_client_lwt/Thread/Deferred/index.html#type-t">Amqp_client_lwt.Thread.Deferred.t</a></span></code></dt><dd><p>Make an rpc call to the exchange using the routing key and headers.</p><dl><dt>parameter ttl</dt><dd><p>is the message timeout in milliseconds. If the message is on the rpc endpoints queue for more than <code>ttl</code> milliseconds the message will be dead lettered and returned which will cause this function to timeout and return None.</p></dd></dl><dl><dt>parameter grace_time_ms</dt><dd><p>is the time added to the ttl before the function times out and returns None This is to give the rpc serve a chance to process the message, in case the rpc server consumed the message from the queue close to ttl. Default 100ms.</p><p>To call directly to a named queue, use <code>call t Exchange.default ~ttl:500 ~routing_key:&quot;name_of_the_queue&quot; ~headers:[]</code></p><p><code>correlation_id</code> allows you to specify a correlation id. The id will be suffixed with an id to allow the caller to reuse correlation ids. This can be used for tracing by reusing correlation ids of incomming requests resulting in new calls. If no correlation is given the id of the <code>client</code> is used.</p><p>The function allows the call to specify both a routing key and headers regardless of the type of exchange used, as exchanges may be chained in a way where both headers and routing keys are used.</p><p>This function will timeout and return None, either if the request message is dead-lettered or if ttl + grace_time_ms has passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-close"><a href="#val-close" class="anchor"></a><code><span class="keyword">val</span> close : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit <a href="../../Amqp_client_lwt/Thread/Deferred/index.html#type-t">Amqp_client_lwt.Thread.Deferred.t</a></span></code></dt><dd><p>Release resources</p></dd></dl></div></body></html>